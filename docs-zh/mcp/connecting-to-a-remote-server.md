---
title: "连接到远程服务器"
description: "模型上下文协议 (MCP) 允许 Cline 与提供额外工具和资源的外部服务器通信以扩展其能力。本指南解释了如何通过 MCP 服务器界面添加和连接远程 MCP 服务器。"
---

## 添加和管理远程 MCP 服务器

### 访问 MCP 服务器界面

要在 Cline 中访问 MCP 服务器界面：

1. 单击 VSCode 侧边栏中的 Cline 图标
2. 打开 Cline 面板右上角的菜单（⋮）
3. 从下拉菜单中选择"MCP 服务器"

### 了解 MCP 服务器界面

MCP 服务器界面分为三个主要选项卡：

-   **市场**：发现和安装预配置的 MCP 服务器（如果启用）
-   **远程服务器**：通过 URL 端点连接到现有的 MCP 服务器
-   **已安装**：管理你已连接的 MCP 服务器

### 添加远程 MCP 服务器

"远程服务器"选项卡允许你连接到可通过 URL 端点访问的任何 MCP 服务器：

1. 在 MCP 服务器界面中单击"远程服务器"选项卡
2. 填写必需的信息：
    - **服务器名称**：为服务器提供一个唯一、描述性的名称
    - **服务器 URL**：输入 MCP 服务器的完整 URL 端点（例如，`https://example.com/mcp-sse`）
    - **传输类型**：选择连接协议（对于现代服务器，推荐使用可流式 HTTP）
3. 单击"添加服务器"以启动连接
4. Cline 将尝试连接到服务器并显示连接状态

> **注意**：连接到远程服务器时，确保你信任该源，因为 MCP 服务器可以在你的环境中执行代码。

#### 传输类型

Cline 支持两种用于远程 MCP 服务器的传输协议：

-   **可流式 HTTP（推荐）**：现代 MCP 传输协议，具有更好的性能、可靠性和完整的 OAuth 2.1 身份验证支持。将其用于大多数远程服务器。
-   **SSE（旧版）**：服务器发送事件传输。仅当服务器特别要求 SSE 或不支持可流式 HTTP 时才使用此选项。

#### OAuth 身份验证

某些 MCP 服务器（如 Vercel 的 MCP）需要 OAuth 身份验证以安全访问你的数据。连接到支持 OAuth 的服务器时：

1. 使用其 URL 按常规方式添加服务器
2. 如果服务器需要身份验证，你将看到一条错误消息，要求你进行身份验证
3. 单击出现的**"身份验证"**按钮
4. 你的浏览器将打开到服务器的授权页面
5. 登录并授予权限
6. 你将自动重定向回 Cline
7. 服务器将连接并显示绿色状态点

一旦通过身份验证，你的凭证将安全存储，当你重新加载 Cline 时服务器将自动重新连接。除非你删除服务器或你的凭证过期，否则你不需要再次进行身份验证。

### 远程服务器发现

如果你正在寻找要连接的 MCP 服务器，几个第三方市场提供了具有各种功能的可用服务器的目录。

> **警告**：以下第三方市场仅供参考目的而列出。Cline 不背书、验证或对这些市场上列出的任何服务器承担责任。这些服务器是处理你的请求的云托管服务，并且可能有权访问你与它们共享的数据。在连接到第三方服务之前，请始终审查隐私政策和使用条款。

#### Composio MCP 集成

[Composio 的 MCP 市场](https://mcp.composio.dev/) 提供了对支持模型上下文协议 (MCP) 的广泛第三方服务器的访问。这些服务器暴露了 GitHub、Notion、Slack 等服务的 API。每个服务器都包括配置说明和内置的身份验证支持（例如，OAuth 或 API 密钥）。要连接，请在市场中找到所需的服务并按照那里提供的集成步骤进行操作。

#### 通过 Smithery 连接

Smithery 是一个第三方 MCP 服务器市场，允许用户发现和连接到各种模型上下文协议 (MCP) 服务器。如果你正在使用 MCP 兼容客户端（如 Cursor、Claude Desktop 或 Cline），你可以浏览可用的服务器并将它们直接集成到你的工作流中。

要探索可用选项，请访问 Smithery 市场：[https://smithery.ai](https://smithery.ai)

请注意：Smithery 独立维护，与我们的项目无关联。请自行决定使用。

### 管理已安装的 MCP 服务器

添加后，你的 MCP 服务器将出现在"配置"选项卡中，你可以在其中：

#### 查看服务器状态

每个服务器都显示其当前状态：

-   **绿点**：已连接并准备使用
-   **黄点**：正在连接过程中
-   **红点**：已断开连接或遇到错误

#### 配置服务器设置

单击服务器以展开其设置面板：

1. **工具和资源**：
    - 查看服务器的所有可用工具和资源
    - 配置工具的自动批准设置（如果启用）
2. **请求超时**：
    - 设置 Cline 应该等待服务器响应的时间
    - 选项范围从 30 秒到 1 小时
3. **服务器管理**：
    - **重启服务器**：如果服务器无响应，则重新连接
    - **删除服务器**：从你的配置中删除服务器

#### 启用/禁用服务器

切换每个服务器旁边的开关以启用或禁用它：

-   **已启用**：Cline 可以使用服务器的工具和资源
-   **已禁用**：服务器保留在你的配置中但未激活

### 连接问题故障排除

如果服务器无法连接：

1. 将显示一条错误消息，其中包含有关失败的详细信息
2. **对于 OAuth 错误**：单击"身份验证"按钮以完成授权流程
3. 检查服务器 URL 是否正确以及服务器是否正在运行
4. 尝试选择不同的传输类型（可流式 HTTP vs SSE）
5. 使用"重启服务器"按钮尝试重新连接
6. 如果问题仍然存在，你可以删除服务器并尝试再次添加它

#### OAuth 特定问题

如果你在通过 OAuth 进行身份验证时遇到问题：

-   **"需要身份验证"持续存在**：确保你在浏览器中完成了授权流程并且没有取消它
-   **浏览器无法打开**：检查系统的默认浏览器设置，确保可以打开外部 URL
-   **重定向错误**：验证你正在使用最新版本的 Cline - 旧版本可能不支持 OAuth
-   **重置身份验证**：删除服务器并重新添加它，以使用新的 OAuth 流程重新开始

### 高级配置

对于高级用户，Cline 将 MCP 服务器配置存储在可以修改的 JSON 文件中：

1. 在"配置"选项卡中，单击"配置 MCP 服务器"以访问设置文件
2. 每个服务器的配置遵循以下格式：

```json
{
	"mcpServers": {
		"exampleServer": {
			"url": "https://example.com/mcp-server",
			"type": "streamableHttp",
			"disabled": false,
			"autoApprove": ["tool1", "tool2"],
			"timeout": 60
		}
	}
}
```

关键配置选项：

-   **url**：端点 URL（用于远程服务器）
-   **type**：传输协议 - `"streamableHttp"`（推荐）或 `"sse"`（旧版）
-   **disabled**：服务器当前是否已启用（true/false）
-   **autoApprove**：不需要确认的工具名称列表
-   **timeout**：等待服务器响应的最大时间（秒）（默认：60）

有关其他 MCP 设置，请单击"高级 MCP 设置"链接以访问 VSCode 设置。

### 使用 MCP 服务器工具

连接后，Cline 可以使用 MCP 服务器提供的工具和资源。当 Cline 建议使用 MCP 工具时：

1. 将出现工具批准提示（除非已自动批准）
2. 在批准之前查看工具详细信息和参数
3. 工具将执行并将结果返回给 Cline

### 示例：连接到 Vercel MCP

[Vercel MCP](https://vercel.com/docs/mcp/vercel-mcp) 是一个支持 OAuth 的服务器，提供用于管理你的 Vercel 项目和部署的工具：

1. 单击"远程服务器"选项卡
2. 输入：
    - **服务器名称**：`vercel`
    - **服务器 URL**：`https://mcp.vercel.com`
    - **传输类型**：可流式 HTTP（预先选择）
3. 单击"添加服务器"
4. 你将看到"需要身份验证" - 单击**"身份验证"**按钮
5. 在浏览器中登录到 Vercel 并授权 Cline
6. 返回到 Cline - 服务器将自动连接
7. Vercel 的工具（部署、日志、项目）现在可供 Cline 使用！

你的 Vercel 身份验证在会话之间持续存在，因此你不需要每次使用 Cline 时都重新进行身份验证。
