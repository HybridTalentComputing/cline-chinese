---
title: "深度规划命令"
sidebarTitle: "/deep-planning"
---

`/deep-planning` 将 Cline 变成一个一丝不苟的架构师，他调查你的代码库，提出澄清问题，并在编写任何代码之前创建一个全面的实现计划。 

<Frame>
	<img
		src="https://storage.googleapis.com/cline_public_images/docs/assets/deep-planning.png"
		alt="深度规划命令在实际操作中显示调查和规划过程"
	/>
</Frame>

当你使用 `/deep-planning` 时，Cline 遵循一个四步过程，反映了高级开发者如何处理复杂功能：彻底调查、需求的讨论和澄清、详细规划，以及带有进度跟踪的结构化任务创建。

## 四步过程

### 第一步：静默调查

Cline 变成一个侦探，默默探索你的代码库以了解其结构、模式和约束。他检查源文件，分析导入模式，发现类层次结构，并识别技术债务标记。没有评论，没有旁白 — 只是专注的研究。

在此阶段，Cline 运行如下命令：
- 查找代码库中的所有类和函数定义
- 分析导入模式以了解依赖关系
- 发现项目结构和文件组织
- 识别 TODO 和技术债务

### 第二步：讨论和问题

一旦 Cline 理解了你的代码库，他会提出将塑造实现的具体问题。这些不是一般性问题 — 它们特定于你的项目和你正在构建的功能。

问题可能涵盖：
- 澄清模糊的需求
- 在同样有效的实现方法之间做出选择
- 确认有关系统行为的假设
- 理解技术决策的偏好

### 第三步：实现计划文档

Cline 创建一个结构化的 markdown 文档（`implementation_plan.md`），作为你的实现蓝图。这不是一个模糊的大纲 — 它是一个具有精确文件路径、函数签名和实现顺序的详细规范。

该计划包括八个综合部分：
- **概述**：目标和高级方法
- **类型**：完整的类型定义和数据结构
- **文件**：要创建、修改或删除的确切文件
- **函数**：带有签名的新函数和修改的函数
- **类**：类修改和继承细节
- **依赖项**：包要求和版本
- **测试**：验证策略和测试要求
- **实现顺序**：逐步执行序列

### 第四步：实现任务创建

Cline 创建一个新任务，引用计划文档并包含可跟踪的实现步骤。该任务带有读取计划每个部分的具体命令，确保实现代理（无论是你还是 Act Mode 中的 Cline）可以高效地导航蓝图。

<Tip>
  深度规划与[焦点链](/features/focus-chain)完美配合。实现步骤自动变成带有实时进度跟踪的待办事项列表，使复杂项目保持有序和正轨。
</Tip>

## 使用深度规划

通过输入 `/deep-planning` 后跟你的功能描述来开始深度规划会话：

```
/deep-planning 添加用户身份验证，使用 JWT 令牌和基于角色的访问控制
```

Cline 将立即开始他的调查。你会看到他读取文件和运行命令以了解你的代码库。一旦他收集了足够的上下文，他会在创建计划之前与你进行讨论。

## 示例工作流

这是我为真实功能使用 `/deep-planning` 的方式：

<Steps>
  <Step title="启动规划">
    我输入 `/deep-planning 实现一个用于 API 响应的缓存层`
  </Step>
  <Step title="静默调查">
    Cline 探索我的代码库，检查：
    - 当前 API 结构和端点
    - 现有数据流模式
    - 数据库查询和性能瓶颈
    - 配置和环境设置
  </Step>
  <Step title="针对性讨论">
    Cline 问我：
    - "我们应该使用 Redis 还是内存缓存？"
    - "用户数据的可接受缓存过期时间是多少？"
    - "你需要缓存失效 webhook 吗？"
  </Step>
  <Step title="计划创建">
    Cline 生成 `implementation_plan.md`，包括：
    - 缓存服务类规范
    - Redis 连接配置
    - 带有缓存逻辑的修改 API 端点
    - 缓存密钥生成策略
    - 不同数据类型的 TTL 配置
  </Step>
  <Step title="任务生成">
    Cline 创建一个新任务，包括：
    - 对实现计划的引用
    - 读取特定部分的命令
    - 每个实现步骤的可跟踪待办事项
    - 切换到 Act Mode 执行的请求
  </Step>
</Steps>

## 与计划/执行模式集成

深度规划设计为与[计划/执行模式](/features/plan-and-act)无缝工作：

- 在计划模式中使用 `/deep-planning` 进行调查和规划阶段
- 生成的任务请求切换到执行模式进行实现
- 焦点链自动跟踪实现步骤的进度

这种分离确保规划专注于架构，而实现专注于执行。

## 最佳实践

### 何时使用深度规划

对以下情况使用 `/deep-planning`：
- 触及代码库多个部分的功能
- 需要仔细协调的架构更改
- 与外部服务的复杂集成
- 需要系统执行的重构工作
- 任何通常需要花时间白板规划的功能

### 充分利用调查

让 Cline 彻底完成他的调查。计划的质量与他对你的代码库的理解程度直接相关。如果你有他应该检查的特定区域，请在你的初始请求中提及。

### 审查计划

在开始实施之前始终审查 `implementation_plan.md`。计划是全面的但不是不可变的 — 如果需要，你可以直接编辑它。将其视为你和 Cline 之间的协作文档。

### 跟踪进度

启用焦点链后，你的实现进度显示在任务标题中。当 Cline 完成计划时，每个完成的步骤会自动勾选，让你实时了解复杂实现。

## 灵感

每当我要构建通常需要设计文档的东西时，我都会使用 `/deep-planning`。我工作流中的最近示例：

- **迁移身份验证系统**：深度规划映射了每个端点，识别了所有身份验证接触点，并创建了一个避免破坏性更改的迁移计划。

- **添加实时功能**：该计划涵盖了 WebSocket 集成、事件处理、状态同步以及断开连接的回退机制。

- **数据库模式重构**：Cline 识别了所有受影响的查询，创建了迁移脚本，并计划了推出以最大限度地减少停机时间。

- **API 版本控制实现**：该计划详细说明了路由更改、向后兼容性层、弃用通知和客户端迁移路径。

`/deep-planning` 的力量在于它在实现之前强制深思熟虑的架构。这就像在编写代码之前让高级开发者审查你的方法，除了该开发者对你整个代码库有完美的了解。

<Note>
  深度规划需要具有强大推理能力的模型。它最适合最新一代的模型，如 GPT-5、Claude 4、Gemini 2.5 或 Grok 4。较小的模型可能会难以满足所需的全面分析。
</Note>

对于不需要大量规划的简单任务，考虑使用 [/newtask](/features/slash-commands/new-task) 创建带有上下文的专注任务，或者如果前进路径清晰，则直接跳转到实现。
